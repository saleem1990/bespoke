/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package inventory;

/**
 *
 * @author System Partners
 */
public class SupplierRegister extends javax.swing.JInternalFrame {

    /**
     * Creates new form SupplierRegister
     */
    public SupplierRegister() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {
        java.awt.GridBagConstraints gridBagConstraints;

        jPanel52 = new javax.swing.JPanel();
        jLabel572 = new javax.swing.JLabel();
        jLabel582 = new javax.swing.JLabel();
        jLabel592 = new javax.swing.JLabel();
        jLabel602 = new javax.swing.JLabel();
        jLabel612 = new javax.swing.JLabel();
        jLabel622 = new javax.swing.JLabel();
        jLabel642 = new javax.swing.JLabel();
        jLabel652 = new javax.swing.JLabel();
        jTextField482 = new javax.swing.JTextField();
        jTextField492 = new javax.swing.JTextField();
        jTextField561 = new javax.swing.JTextField();
        jTextField582 = new javax.swing.JTextField();
        clearbtn = new javax.swing.JButton();
        jButton252 = new javax.swing.JButton();
        jSeparator71 = new javax.swing.JSeparator();
        saveData = new javax.swing.JButton();
        jTextField14 = new javax.swing.JTextField();
        jLabel15 = new javax.swing.JLabel();
        jLabel25 = new javax.swing.JLabel();
        jTextField59 = new javax.swing.JTextField();
        jLabel66 = new javax.swing.JLabel();
        jLabel2 = new javax.swing.JLabel();
        jTextField5412 = new javax.swing.JTextField();
        supplierNametxt = new javax.swing.JTextField();
        jLabel6 = new javax.swing.JLabel();
        jTextField5 = new javax.swing.JTextField();
        jTextField3 = new javax.swing.JTextField();
        jTextField6 = new javax.swing.JTextField();
        jLabel13 = new javax.swing.JLabel();
        jPanel411 = new javax.swing.JPanel();
        originalSupNametxt = new javax.swing.JTextField();
        searchButton11 = new javax.swing.JButton();
        jLabel573 = new javax.swing.JLabel();
        jTextField5723 = new javax.swing.JTextField();
        jLabel574 = new javax.swing.JLabel();
        jTextField5724 = new javax.swing.JTextField();
        jTextField583 = new javax.swing.JTextField();

        setClosable(true);
        setIconifiable(true);
        setMaximizable(true);
        setResizable(true);
        setTitle("Register Supplier");
        setToolTipText("");
        getContentPane().setLayout(new java.awt.GridBagLayout());

        jPanel52.setLayout(new java.awt.GridBagLayout());

        jLabel572.setText("Bank Account No");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 7;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel572, gridBagConstraints);

        jLabel582.setText("Supplier Name");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel582, gridBagConstraints);

        jLabel592.setText("Town");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel592, gridBagConstraints);

        jLabel602.setText("Postal Address");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel602, gridBagConstraints);

        jLabel612.setText("Email Address");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel612, gridBagConstraints);

        jLabel622.setText("Telephone No");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel622, gridBagConstraints);

        jLabel642.setText("Business/Company Reg No");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel642, gridBagConstraints);

        jLabel652.setText("Country");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel652, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel52.add(jTextField482, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        jPanel52.add(jTextField492, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel52.add(jTextField561, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 7;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jTextField582, gridBagConstraints);

        clearbtn.setMnemonic('l');
        clearbtn.setText("Clear");
        clearbtn.setToolTipText("Click here to clear fields");
        clearbtn.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                clearbtnActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 11;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(clearbtn, gridBagConstraints);

        jButton252.setMnemonic('c');
        jButton252.setText("Close");
        jButton252.setToolTipText("Click here to close window");
        jButton252.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jButton252ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 11;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jButton252, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 9;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel52.add(jSeparator71, gridBagConstraints);

        saveData.setMnemonic('O');
        saveData.setText("Save");
        saveData.setToolTipText("Click here to enter data");
        saveData.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                saveDataActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 11;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(saveData, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel52.add(jTextField14, gridBagConstraints);

        jLabel15.setText("County");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 3;
        jPanel52.add(jLabel15, gridBagConstraints);

        jLabel25.setText("Website/URL");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel25, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel52.add(jTextField59, gridBagConstraints);

        jLabel66.setText("KRA PIN");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 5;
        jPanel52.add(jLabel66, gridBagConstraints);

        jLabel2.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 10;
        gridBagConstraints.gridwidth = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel52.add(jLabel2, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jTextField5412, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 1;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(supplierNametxt, gridBagConstraints);

        jLabel6.setText("Contact Person");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 5;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel6, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel52.add(jTextField5, gridBagConstraints);

        jTextField3.setText("Kenya");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 4;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        jPanel52.add(jTextField3, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 3;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jTextField6, gridBagConstraints);

        jLabel13.setText("Search Name for Editing");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 0;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.anchor = java.awt.GridBagConstraints.WEST;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 30, 0, 0);
        jPanel52.add(jLabel13, gridBagConstraints);

        jPanel411.setBorder(javax.swing.BorderFactory.createEtchedBorder());
        jPanel411.setLayout(new java.awt.GridBagLayout());

        originalSupNametxt.setEditable(false);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel411.add(originalSupNametxt, gridBagConstraints);

        searchButton11.setToolTipText("Search");
        searchButton11.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        searchButton11.setMaximumSize(new java.awt.Dimension(74, 53));
        searchButton11.setMinimumSize(new java.awt.Dimension(74, 53));
        searchButton11.setVerticalTextPosition(javax.swing.SwingConstants.BOTTOM);
        searchButton11.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                searchButton11ActionPerformed(evt);
            }
        });
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 2;
        gridBagConstraints.gridy = 2;
        jPanel411.add(searchButton11, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 0;
        gridBagConstraints.gridwidth = 2;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 3.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jPanel411, gridBagConstraints);

        jLabel573.setText("Bank/Branch");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 7;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel573, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 7;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel52.add(jTextField5723, gridBagConstraints);

        jLabel574.setText("VAT No");
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 3;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jLabel574, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 4;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        gridBagConstraints.insets = new java.awt.Insets(0, 0, 0, 20);
        jPanel52.add(jTextField5724, gridBagConstraints);
        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.gridx = 1;
        gridBagConstraints.gridy = 6;
        gridBagConstraints.fill = java.awt.GridBagConstraints.HORIZONTAL;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        jPanel52.add(jTextField583, gridBagConstraints);

        gridBagConstraints = new java.awt.GridBagConstraints();
        gridBagConstraints.fill = java.awt.GridBagConstraints.BOTH;
        gridBagConstraints.weightx = 1.0;
        gridBagConstraints.weighty = 1.0;
        getContentPane().add(jPanel52, gridBagConstraints);

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void clearbtnActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_clearbtnActionPerformed
        supplierNametxt.setText("");
        jTextField482.setText("");
        jTextField5412.setText("");
        jTextField492.setText("");
        jTextField5722.setText("");
        //extField482.setText("");
        jTextField561.setText("");
        jTextField582.setText("");
        jTextField59.setText("");
        jTextField14.setText("");
        jTextField3.setText("");
        //      jComboBox2.setSelectedItem(null);
        // Add your handling code here:
    }//GEN-LAST:event_clearbtnActionPerformed

    private void jButton252ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jButton252ActionPerformed
        setVisible(false);   // Add your handling code here:
    }//GEN-LAST:event_jButton252ActionPerformed

    private void saveDataActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_saveDataActionPerformed
        String receiptNo = null;
        try {
            connectDB.setAutoCommit(false);
            java.sql.Statement pss = connectDB.createStatement();

            if (this.jCheckBox5.isSelected() && !saveData.getText().equalsIgnoreCase("Update")) {
                java.sql.ResultSet rsts = pss.executeQuery("select 'CR'||nextval('creditors_seq')");
                while (rsts.next()) {
                    // rsts.getObject(1).toString();

                    receiptNo = rsts.getObject(1).toString();
                }
            }

            if (saveData.getText().equalsIgnoreCase("Update")) {
                // Updating existing supplier details
                int exitOption = javax.swing.JOptionPane.showConfirmDialog(this, "You are Updating (a) Record(s) for [" + jTextField582.getText() + "] - [ " + supplierNametxt.getText() + "]. This may take a while. \n Yes to Continue", "Caution before Saving!", javax.swing.JOptionPane.YES_NO_CANCEL_OPTION);

                if (exitOption == javax.swing.JOptionPane.YES_OPTION) {

                    this.setCursor(new java.awt.Cursor(java.awt.Cursor.WAIT_CURSOR));

                    java.sql.PreparedStatement pstmt = connectDB.prepareStatement("UPDATE st_suppliers"
                        + " SET supplier_name=?, short_name=?, town=?, country=?, district=?, "
                        + " contact_person=?, tel1=?, tel2=?, fax_no=?, email_address=?, "
                        + " website=?, postal_address=?, street=?, avenue=?, locality=?, "
                        + " building_name=?, floor_no=?, category=?, town1=?, pin_no=?, rog_no=?, "
                        + " gl_code=?, tax_no=?, vat_no=?, bank_name = ?, bank_branch = ?, bank_account_no = ?, bank_transfer_code = ?"
                        + " WHERE code = '" + jTextField582.getText() + "'");

                    pstmt.setString(1, supplierNametxt.getText());
                    pstmt.setString(2, jTextField5412.getText());
                    // pstmt.setString(3,jTextField5412.getText());
                    pstmt.setString(3, jTextField492.getText());
                    pstmt.setString(4, jTextField3.getText());
                    pstmt.setString(5, jTextField6.getText());
                    pstmt.setString(6, jTextField5.getText());
                    pstmt.setString(7, jTextField5722.getText());
                    pstmt.setString(8, jTextField561.getText());
                    pstmt.setString(9, jTextField14.getText());
                    pstmt.setString(10, jTextField482.getText());
                    pstmt.setString(11, jTextField59.getText());
                    pstmt.setString(12, jTextField58221.getText());
                    pstmt.setString(13, jTextField50221.getText());
                    pstmt.setString(14, jTextField53221.getText());
                    pstmt.setString(15, jTextField1.getText());
                    pstmt.setString(16, jTextField6021.getText());
                    pstmt.setString(17, jTextField54121.getText());
                    pstmt.setString(18, jComboBox1.getSelectedItem().toString());
                    pstmt.setString(19, serviceType.getSelectedItem().toString());
                    pstmt.setString(20, jTextField58.getText());
                    pstmt.setString(21, jTextField50.getText());
                    pstmt.setString(22, jTextField9.getText());
                    pstmt.setString(23, jTextField54.getText());
                    pstmt.setString(24, jTextField49.getText());
                    pstmt.setString(25, this.bankNameTxt.getText());
                    pstmt.setString(26, this.bankBranchTxt.getText());
                    pstmt.setString(27, this.bankAccountTxt.getText());
                    pstmt.setString(28, this.bankTrasferCodeTxt.getText());
                    // pstmt.setString(26,jTextPane3.getText());

                    pstmt.executeUpdate();
                    //3.2

                    pstmt = connectDB.prepareStatement("UPDATE st_sub_stores SET sub_store = '" + supplierNametxt.getText() + "' WHERE trim(sub_store) = '" + originalSupNametxt.getText() + "'  ");
                    pstmt.executeUpdate();

                    System.err.println("Done==1");

                    pstmt = connectDB.prepareStatement("UPDATE st_stock_cardex SET delivered_by = '" + supplierNametxt.getText() + "', supplier = '" + supplierNametxt.getText() + "' WHERE trim(supplier) = '" + originalSupNametxt.getText() + "' ");
                    pstmt.executeUpdate();

                    System.err.println("Done ==2");

                    pstmt = connectDB.prepareStatement("UPDATE st_orders SET supplier = '" + supplierNametxt.getText() + "' WHERE trim(supplier) = '" + originalSupNametxt.getText() + "' ");
                    pstmt.executeUpdate();
                    System.err.println("Done==3");

                    pstmt = connectDB.prepareStatement("UPDATE st_recommendation SET supplier = '" + supplierNametxt.getText() + "' WHERE trim(supplier) ='" + originalSupNametxt.getText() + "' ");
                    pstmt.executeUpdate();
                    System.err.println("Done==4");

                    pstmt = connectDB.prepareStatement("UPDATE st_floated_quotations SET supplier = '" + supplierNametxt.getText() + "' WHERE trim(supplier) = '" + originalSupNametxt.getText() + "' ");
                    pstmt.executeUpdate();

                    System.err.println("Done==5");

                    pstmt = connectDB.prepareStatement("UPDATE ac_accounts_payable SET dealer = '" + supplierNametxt.getText() + "' WHERE trim(dealer) = '" + originalSupNametxt.getText() + "' ");
                    pstmt.executeUpdate();

                    System.err.println("Done==6");

                    pstmt = connectDB.prepareStatement("UPDATE ac_accounts_payable SET payee = '" + supplierNametxt.getText() + "' WHERE payee ilike '" + originalSupNametxt.getText() + "' ");
                    pstmt.executeUpdate();
                    System.err.println("Done==7\n\n Skipped 8");

                    pstmt = connectDB.prepareStatement("UPDATE ac_dashboard SET supplier = '" + supplierNametxt.getText() + "' WHERE supplier ilike '" + originalSupNametxt.getText() + "' ");
                    pstmt.executeUpdate();
                    System.err.println("Done==9");

                    pstmt = connectDB.prepareStatement("UPDATE ac_reprinting_vouchers SET payee= '" + supplierNametxt.getText() + "' WHERE payee ilike '" + originalSupNametxt.getText() + "' ");
                    pstmt.executeUpdate();

                    System.err.println("Done==10\n\n back to ac_ledger");

                    pstmt = connectDB.prepareStatement("UPDATE ac_ledger SET dealer = '" + supplierNametxt.getText() + "' WHERE dealer = '" + originalSupNametxt.getText() + "' ");
                    pstmt.executeUpdate();
                    System.err.println("Done==8");

                    System.err.println("Funsoft supplier update -Cascaded- version 3.2");

                }

                javax.swing.JOptionPane.showMessageDialog(this, "The update was successful", "Confirmation Message!", javax.swing.JOptionPane.INFORMATION_MESSAGE);
                activity = "Creditors name update[" + originalSupNametxt.getText() + "] to [" + supplierNametxt.getText() + "]";

                GetItemInfo.updateTrail(activity, connectDB);
                this.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
                saveData.setLabel("Save");
            }
            else {

                //Inserting new details in suppliers list
                java.sql.PreparedStatement pstmt = connectDB.prepareStatement("INSERT INTO st_suppliers values( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
                if (this.jCheckBox5.isSelected()) {
                    pstmt.setString(1, receiptNo);
                } else {
                    pstmt.setString(1, jTextField582.getText());
                }
                //  pstmt.setString(1,jTextField582.getText());
                pstmt.setString(2, supplierNametxt.getText().toUpperCase());
                pstmt.setString(6, jTextField6.getText());
                pstmt.setString(5, jTextField3.getText());
                pstmt.setString(3, jTextField5412.getText().toUpperCase());
                pstmt.setString(4, jTextField492.getText());
                pstmt.setString(7, jTextField5.getText());
                pstmt.setString(8, jTextField5722.getText());
                pstmt.setString(9, jTextField561.getText());
                pstmt.setString(10, jTextField14.getText());
                pstmt.setString(11, jTextField482.getText());
                pstmt.setString(12, jTextField59.getText());
                pstmt.setString(13, jTextField58221.getText());
                pstmt.setString(14, jTextField50221.getText());
                pstmt.setString(15, jTextField53221.getText());
                pstmt.setString(16, jTextField1.getText());
                pstmt.setString(17, jTextField6021.getText());
                pstmt.setString(18, jTextField54121.getText());
                pstmt.setString(19, jTextField49221.getText());
                pstmt.setString(20, jComboBox1.getSelectedItem().toString());
                pstmt.setString(21, jTextField58.getText());
                pstmt.setString(22, jTextField50.getText());
                pstmt.setString(23, jTextField11.getText());
                pstmt.setString(25, jTextField49.getText());
                pstmt.setString(24, jTextField54.getText());
                pstmt.setString(26, jTextField60.getText());
                pstmt.setDate(27, com.afrisoftech.lib.ServerTime.getSQLDate(connectDB));
                pstmt.setDouble(28, 0.00);
                pstmt.setString(29, null);
                pstmt.setString(30, null);
                pstmt.setBoolean(31, false);
                pstmt.setDate(32, com.afrisoftech.lib.ServerTime.getSQLDate(connectDB));
                pstmt.setString(33, jTextField60.getText());
                pstmt.setString(34, this.bankNameTxt.getText());
                pstmt.setString(35, this.bankBranchTxt.getText());
                pstmt.setString(36, this.bankAccountTxt.getText());
                pstmt.setString(37, this.bankTrasferCodeTxt.getText());
                pstmt.executeUpdate();

                double Bal = java.lang.Double.parseDouble(this.jTextField8.getText());
                if (Bal > 0) {
                    String Stock = null;
                    String voucNo = null;
                    String accountCode = null;
                    String TransNo = null;
                    String glType = null;
                    // String glType = null;
                    String userName = null;

                    java.sql.Statement pst1 = connectDB.createStatement();
                    java.sql.ResultSet rs1 = pst1.executeQuery("select code,activity from pb_activity where activity_category ilike 'CP%'");
                    while (rs1.next()) {
                        accountCode = rs1.getObject(1).toString();
                        glType = rs1.getObject(2).toString();
                    }
                    java.sql.Statement ps = connectDB.createStatement();
                    java.sql.ResultSet rs2 = ps.executeQuery("select nextval('transaction_no_seq'),current_user");
                    while (rs2.next()) {
                        TransNo = rs2.getObject(1).toString();
                        userName = rs2.getObject(2).toString();
                    }
                    java.sql.Statement pst2 = connectDB.createStatement();
                    java.sql.ResultSet rs = pst2.executeQuery("select 'IN'||lpad(nextval('invoice_no_seq'),5,0)");
                    while (rs.next()) {
                        voucNo = rs.getObject(1).toString();
                    }
                    java.sql.PreparedStatement pstmt2 = connectDB.prepareStatement("insert into ac_ledger values(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?,?,?)");
                    pstmt2.setString(1, jTextField9.getText().toString());
                    pstmt2.setObject(2, serviceType.getSelectedItem());
                    pstmt2.setString(3, "");
                    if (supplierNametxt.getText() == null) {
                        javax.swing.JOptionPane.showMessageDialog(this, "You must Enter Payee!", "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
                    } else {
                        pstmt2.setObject(4, supplierNametxt.getText().toString());
                    }
                    pstmt2.setObject(5, "Opening Balance");
                    pstmt2.setString(6, "");
                    pstmt2.setObject(7, supplierNametxt.getText().toString());
                    pstmt2.setString(8, "");
                    pstmt2.setString(9, "");
                    pstmt2.setString(10, "");
                    pstmt2.setString(11, "");
                    pstmt2.setString(12, "");
                    pstmt2.setString(13, "");
                    pstmt2.setString(14, "Bfwd");
                    pstmt2.setString(15, "Raise Invoice");
                    pstmt2.setDouble(17, 0.00);
                    pstmt2.setDouble(16, java.lang.Double.valueOf(jTextField8.getText().toString()));
                    pstmt2.setDate(18, com.afrisoftech.lib.SQLDateFormat.getSQLDate(datePicker1.getDate()));
                    pstmt2.setString(19, TransNo);
                    pstmt2.setBoolean(20, false);
                    pstmt2.setBoolean(21, false);
                    pstmt2.setBoolean(22, false);
                    pstmt2.setString(23, userName);
                    pstmt2.executeUpdate();

                    java.sql.PreparedStatement pstmt1 = connectDB.prepareStatement("insert into ac_accounts_payable values(?,?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?,?,?,?,?,?,?,?,?)");
                    pstmt1.setString(1, accountCode);
                    pstmt1.setString(2, supplierNametxt.getText().toString());
                    pstmt1.setObject(3, serviceType.getSelectedItem());
                    pstmt1.setString(4, "");
                    pstmt1.setObject(5, supplierNametxt.getText().toString());
                    pstmt1.setString(6, "Opening Balance");
                    if (this.jCheckBox5.isSelected()) {
                        pstmt1.setString(7, receiptNo);
                    } else {
                        pstmt1.setString(7, jTextField582.getText());
                    }
                    pstmt1.setString(8, "");
                    pstmt1.setString(9, "");
                    pstmt1.setString(10, "");
                    pstmt1.setString(11, TransNo);
                    pstmt1.setString(12, "Raise Invoice");
                    pstmt1.setDouble(13, 0.00);
                    pstmt1.setDouble(14, java.lang.Double.valueOf(jTextField8.getText().toString()));
                    pstmt1.setDate(15, com.afrisoftech.lib.SQLDateFormat.getSQLDate(datePicker1.getDate()));
                    pstmt1.setObject(16, voucNo);
                    pstmt1.setString(17, glType);
                    pstmt1.setBoolean(18, false);
                    pstmt1.setBoolean(19, false);
                    pstmt1.setString(20, userName);
                    pstmt1.setString(21, "");
                    pstmt1.setObject(22, datePicker1.getDate().toString());
                    pstmt1.setDate(23, com.afrisoftech.lib.SQLDateFormat.getSQLDate(datePicker1.getDate()));
                    pstmt1.setDouble(24, 0.00);
                    pstmt1.setDouble(25, java.lang.Double.valueOf(jTextField8.getText().toString()));
                    pstmt1.setDouble(26, 0.00);

                    pstmt1.executeUpdate();

                }

                javax.swing.JOptionPane.showMessageDialog(this, "The supplier was created successfully", "Confirmation Message!", javax.swing.JOptionPane.INFORMATION_MESSAGE);

                GetItemInfo.updateTrail("Created Creditor " + supplierNametxt.getText() + " -" + jTextField582.getText(), connectDB);

                this.invalidate();
                this.validate();
                clearbtn.doClick();
                //javax.swing.JOptionPane.showMessageDialog(this, "Data Successfully Saved", "Comfirmation Message!", javax.swing.JOptionPane.INFORMATION_MESSAGE);
                /////////DailyBedReturnPdf
            }

            connectDB.commit();
            connectDB.setAutoCommit(true);

        } catch (java.sql.SQLException sq) {
            sq.printStackTrace();
            try {
                connectDB.rollback();
            } catch (java.sql.SQLException sql) {
                sql.printStackTrace();
                javax.swing.JOptionPane.showMessageDialog(this, sql.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
            }
            javax.swing.JOptionPane.showMessageDialog(this, sq.getMessage(), "Error Message!", javax.swing.JOptionPane.ERROR_MESSAGE);
            System.out.println(sq.getMessage());
            ///--1199048
        } // Add your handling code here:
    }//GEN-LAST:event_saveDataActionPerformed

    private void searchButton11ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_searchButton11ActionPerformed
        searchButton221Clicked();         // Add your handling code here:
        // Add your handling code here:
    }//GEN-LAST:event_searchButton11ActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton clearbtn;
    private javax.swing.JButton jButton252;
    private javax.swing.JLabel jLabel13;
    private javax.swing.JLabel jLabel15;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JLabel jLabel25;
    private javax.swing.JLabel jLabel572;
    private javax.swing.JLabel jLabel573;
    private javax.swing.JLabel jLabel574;
    private javax.swing.JLabel jLabel582;
    private javax.swing.JLabel jLabel592;
    private javax.swing.JLabel jLabel6;
    private javax.swing.JLabel jLabel602;
    private javax.swing.JLabel jLabel612;
    private javax.swing.JLabel jLabel622;
    private javax.swing.JLabel jLabel642;
    private javax.swing.JLabel jLabel652;
    private javax.swing.JLabel jLabel66;
    private javax.swing.JPanel jPanel411;
    private javax.swing.JPanel jPanel52;
    private javax.swing.JSeparator jSeparator71;
    private javax.swing.JTextField jTextField14;
    private javax.swing.JTextField jTextField3;
    private javax.swing.JTextField jTextField482;
    private javax.swing.JTextField jTextField492;
    private javax.swing.JTextField jTextField5;
    private javax.swing.JTextField jTextField5412;
    private javax.swing.JTextField jTextField561;
    private javax.swing.JTextField jTextField5723;
    private javax.swing.JTextField jTextField5724;
    private javax.swing.JTextField jTextField582;
    private javax.swing.JTextField jTextField583;
    private javax.swing.JTextField jTextField59;
    private javax.swing.JTextField jTextField6;
    private javax.swing.JTextField originalSupNametxt;
    private javax.swing.JButton saveData;
    private javax.swing.JButton searchButton11;
    private javax.swing.JTextField supplierNametxt;
    // End of variables declaration//GEN-END:variables
}
